@*
 * Copyright 2021 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import config.ApplicationConfig

@import uk.gov.hmrc.play.views.html.{layouts => playLayouts}
@import controllers.auth.CommonRequest
@import scala.concurrent.ExecutionContext
@import uk.gov.hmrc.play.views.html.layouts._


@this(article: Article)

@(
    title: String,
    includeGridWrapper: Boolean = false,
    articleClasses: Option[String] = None
)(
    mainContent: Html
)(
    implicit request: Request[_],
    messages: Messages,
    templateRenderer: uk.gov.hmrc.renderer.TemplateRenderer,
    appConfig: ApplicationConfig,
        ec: ExecutionContext
)


@scriptElement = @{
    Map("url" -> routes.Assets.versioned("javascripts/ats-app.js"))
}


@pageTitle = {@title - @Messages("generic.ats") - GOV.UK}


@isWelsh = @{
    messages.lang.code == "cy" && appConfig.isWelshEnabled
}



@accessibilityFooterUrl = {
    @appConfig.accessibilityStatementUrl(request.uri)
}

@{

    val languageSelectorLanguages = if (appConfig.isWelshEnabled) {
        Map("enUrl" -> controllers.paye.routes.PayeLanguageController.switchToLanguage("english"),
            "cyUrl" -> controllers.paye.routes.PayeLanguageController.switchToLanguage("welsh")
        )
        } else {
            Map.empty
        }

    val arguments:Map[String,Any] = Map[String, Any](
        "pageTitle" -> Some(pageTitle),
        "navTitle" -> messages("generic.ats"),
        "scriptElems" -> scriptElement,
        "isGovernmentGateway" -> false,
        "isVerify" -> false,
        "isSa" -> false,
        "assetsPath" -> appConfig.assetsPrefix,
        "isWelsh" -> isWelsh,
        "ssoUrl" -> None,
        "showPropositionLinks" -> true,
        "langSelector" -> languageSelectorLanguages,
        "hideAccountMenu" -> true
    )

    val extraArguments:Map[String,Any] = if(appConfig.accessibilityStatementToggle) {
        arguments ++ Map[String,Any](
           "accessibilityFooterUrl" -> accessibilityFooterUrl
            )
    } else {
        arguments
    }

    templateRenderer.renderDefaultTemplate(appConfig.frontendTemplatePath, article(mainContent, includeGridWrapper, articleClasses), extraArguments)
}
